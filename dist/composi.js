!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.composi={})}(this,function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=(function(){function e(e){this.value=e}function t(t){var n,o;function r(n,o){try{var l=t[n](o),u=l.value;u instanceof e?Promise.resolve(u.value).then(function(e){r("next",e)},function(e){r("throw",e)}):i(l.done?"return":"normal",l.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":n.resolve({value:t,done:!0});break;case"throw":n.reject(t);break;default:n.resolve({value:t,done:!1})}(n=n.next)?r(n.key,n.arg):o=null}this._invoke=function(e,t){return new Promise(function(i,l){var u={key:e,arg:t,resolve:i,reject:l,next:null};o?o=o.next=u:(n=o=u,r(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=0,i=1,l=3,u="http://www.w3.org/1999/xlink",s="http://www.w3.org/2000/svg",c={},a=[];function f(e,t){var n={};for(var o in e)n[o]=e[o];for(var r in t)n[r]=t[r];return n}function d(e){return!Array.isArray(e)&&"object"===(void 0===e?"undefined":t(e))}var h=function e(){n(this,e),this.message="Cannot insert Fragment tag directly into DOM.",this.toString=function(){return this.message}};function p(e,t,n,o,r,i){return{type:e,props:t,children:n,element:o,key:r,flag:i}}function m(e,t){return p(e,c,a,t,null,l)}function y(e){return p(e.nodeName.toLowerCase(),c,a.map.call(e.childNodes,v),e,null,r)}function v(e){return 3===e.nodeType?m(e.nodeValue,e):y(e)}function g(e){return e.currentTarget.events[e.type](e)}function k(e){return null==e?null:e.key}function b(e,n,o,r,i){if("style"!==n||"object"!==(void 0===r?"undefined":t(r))||Array.isArray(r)){if("key"!==n)if("className"===n&&(n="class"),"o"===n[0]&&"n"===n[1])e.events||(e.events={}),e.events[n=n.slice(2).toLowerCase()]=r,null==r?e.removeEventListener(n,g):null==o&&e.addEventListener(n,g);else{var l=null==r||!1===r||"no"===r||"off"===r;n in e&&"list"!==n&&"type"!==n&&"draggable"!==n&&"spellcheck"!==n&&"translate"!==n&&!i?(e[n]=null==r?"":r,l&&e.removeAttribute(n)):"xlink-href"===n||"xlinkHref"===n?(e.setAttributeNS(u,"href",r),e.setAttribute("href",r)):l?e.removeAttribute(n):e.setAttribute(n,r)}}else for(var s in f(o,r)){var c=null==r||null==r[s]?"":r[s];"-"===s[0]?e[n].setProperty(s,c):e[n][s]=c}}function S(e,t,n){var o=void 0;o=e.flag===l?document.createTextNode(e.type):(n=n||"svg"===e.type)?document.createElementNS(s,e.type):document.createElement(e.type);var r=e.props;r.onmount&&t.push(function(){r.onmount(o)});for(var i=0,u=e.children.length;i<u;i++)o.appendChild(S(e.children[i],t,n));for(var c in r)b(o,c,null,r[c],n);return e.element=o}function N(e,t){function n(){e&&e.nodeType&&e.removeChild(function e(t){for(var n=0,o=t.children.length;n<o;n++)e(t.children[n]);return t.element}(t))}var o=t.props&&t.props.onunmount;null!=o?o(n,t.element):n()}function w(e,t,n,o,i,u){if(o===n);else if(null!=n&&n.flag===l&&o.flag===l)n.type!==o.type&&(t.nodeValue=o.type);else if(null==n||n.type!==o.type){var s=e.insertBefore(S(o,i,u),t);null!=n&&N(e,n),t=s}else{!function(e,t,n,o,r,i){for(var l in f(t,n))("value"===l||"checked"===l?e[l]:t[l])!==n[l]&&b(e,l,t[l],n[l],r);var u=i?n.onmount:n.onupdate;null!=u&&o.push(function(){u(e,t,n)})}(t,n.props,o.props,i,u=u||"svg"===o.type,n.flag===r);for(var c=void 0,a=void 0,d=void 0,h=n.children,p=0,m=h.length-1,y=void 0,v=o.children,g=0,M=v.length-1;g<=M&&p<=m&&(d=k(h[p]),y=k(v[g]),null!=d&&d===y);)w(t,h[p].element,h[p],v[g],i,u),p++,g++;for(;g<=M&&p<=m&&(d=k(h[m]),y=k(v[M]),null!=d&&d===y);)w(t,h[m].element,h[m],v[M],i,u),m--,M--;if(p>m)for(;g<=M;)t.insertBefore(S(v[g++],i,u),(a=h[p])&&a.element);else if(g>M)for(;p<=m;)N(t,h[p++]);else{for(var U=function(e,t,n){for(var o={},r=void 0,i=void 0;t<=n;t++)null!=(r=(i=e[t]).key)&&(o[r]=i);return o}(h,p,m),V={};g<=M;)d=k(a=h[p]),y=k(v[g]),V[d]||null!=y&&y===k(h[p+1])?(null==d&&N(t,a),p++):null==y||n.flag===r?(null==d&&(w(t,a&&a.element,a,v[g],i,u),g++),p++):(d===y?(w(t,a.element,a,v[g],i,u),V[y]=!0,p++):null!=(c=U[y])?(w(t,t.insertBefore(c.element,a&&a.element),c,v[g],i,u),V[y]=!0):w(t,a&&a.element,null,v[g],i,u),g++);for(;p<=m;)null==k(a=h[p++])&&N(t,a);for(var A in U)null==V[A]&&N(t,U[A])}}return o.element=t,o}function M(e,t,n){"string"==typeof n&&(n=document.querySelector(n));var o=[];if(w(n,n.children[0],t,e,o),e!==t)for(;o.length>0;)o.pop()();return e}function U(e,t,n){"string"==typeof t&&(t=document.querySelector(t)),t||(t=document.body);var o=[];if(Array.isArray(e))throw new h;if(n){"string"==typeof n&&(n=document.querySelector(n)),M(e,y(n),t)}else{var r=S(e,o);t.appendChild(r),e.element=r}for(e.element.isMounted=!0;o.length>0;)o.pop()();return e}var V=(new Date).getTime().toString(16),A=function(){function e(t){n(this,e),t||(t={}),this.props=t,this.selector=t.container||"body",t.render&&(this.render=t.render),t.state&&(this.state=t.state),this.selector&&(this.container=document.querySelector(this.selector)),this.currentVNode=null,this.componentShouldUpdate=!0,this.isMounted=!1,this.element=null,this.hydrate=t.hydrate||null,t.componentWillMount&&(this.componentWillMount=t.componentWillMount),t.componentDidMount&&(this.componentDidMount=t.componentDidMount),t.componentWillUpdate&&(this.componentWillUpdate=t.componentWillUpdate),t.componentDidUpdate&&(this.componentDidUpdate=t.componentDidUpdate),t.componentWillUnmount&&(this.componentWillUnmount=t.componentWillUnmount)}return o(e,[{key:"noop",value:function(){}},{key:"componentWillMount",value:function(e){e&&"function"==typeof e&&e.call(e,this)}},{key:"componentDidMount",value:function(){this.noop()}},{key:"componentWillUpdate",value:function(e){e&&"function"==typeof e&&e.call(e,this)}},{key:"componentDidUpdate",value:function(){this.noop()}},{key:"componentWillUnmount",value:function(e){e&&"function"==typeof e&&e.call(e,this)}},{key:"render",value:function(e){return e}},{key:"setState",value:function(e){if("function"==typeof e){var t=void 0;t=d(this.state)?f(c,this.state):Array.isArray(this.state)?a.concat(a,this.state):this.state;var n=e.call(this,t);n&&(this.state=n)}else if(d(this.state)&&d(e)){var o=f(this.state,e);this.state=o}else this.state=e}},{key:"update",value:function(e){if(this.render&&(this.componentShouldUpdate||!this.isMounted)){var t=this.state;!0!==e&&e&&(t=e),this.container&&"string"==typeof this.container&&(this.selector=this.container,this.container=document.querySelector(this.container)),this.hydrate&&!this.isMounted&&("string"==typeof this.hydrate&&(this.hydrate=document.querySelector(this.hydrate)),this.currentVNode=y(this.hydrate));var n,o,r=this.render(t),i=this;if(!this.isMounted)return this.currentVNode?(this.oldVNode=r,this.currentVNode=M(r,this.currentVNode,this.container),this.element=this.currentVNode.element,this.isMounted=!0,this.componentDidMount()):this.componentWillMount(function(){i.oldVNode=r,i.currentVNode=U(r,i.container),i.element=i.currentVNode.element,i.isMounted=!0,i.componentDidMount()}),void(this.container&&1===this.container.nodeType||console.error("The container for this class component is not a valid DOM node. Check the selector provided for the class to make sure it is a valid CSS selector and that the container exists in the DOM. You might be targeting a nonexistent node."));if(n=r,o=this.oldVNode,JSON.stringify(n)!==JSON.stringify(o))this.componentWillUpdate(function(){i.oldVNode=i.render(t),i.currentVNode=M(r,i.currentVNode,i.container),i.element=i.currentVNode.element,i.isMounted=!0,i.componentDidUpdate()})}}},{key:"unmount",value:function(){if(this.element){var e=this;this.componentWillUnmount(function(){e.container.removeChild(e.element);for(var t in e)delete e[t];e.__proto__=null})}}},{key:"state",get:function(){return this[V]},set:function(e){var t=this;this[V]=e,setTimeout(function(){return t.update()},1e3/60)}}]),e}();e.h=function(e,n){for(var o=void 0,r=[],l=[],u=arguments.length,s=Array(u>2?u-2:0),c=2;c<u;c++)s[c-2]=arguments[c];for(var a=s.length,f=(n=n||{}).key;a-- >0;)r.push(s[a]);for(null!=n.children&&(r.length<=0&&r.push(n.children),delete n.children);r.length>0;)if(Array.isArray(o=r.pop()))for(a=o.length;a-- >0;)r.push(o[a]);else!1===o||!0===o||null==o||l.push("object"===(void 0===o?"undefined":t(o))?o:m(o));return delete n.key,"function"==typeof e?e(n,n.children=l):p(e,n,l,null,f,i)},e.mount=U,e.unmount=function(e){function t(){e.element.parentNode.removeChild(e.element),e.element=null}e.props.onunmount?e.props.onunmount(t,e.element):t()},e.render=function(e,t,n){return M(e,t,n)},e.Component=A,e.Fragment=function(e,t){return t},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=composi.js.map
