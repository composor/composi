!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.composi={})}(this,function(t){"use strict";function e(t,e,n,r){return n=a(r||document.body,n,t,e)}function n(t,e,n,r){if("key"===e);else if("style"===e){var o=!0,i=!1,s=void 0;try{for(var a,c=u(r,n=n||{})[Symbol.iterator]();!(o=(a=c.next()).done);o=!0){var l=a.value;t.style[l]=n[l]||""}}catch(t){i=!0,s=t}finally{try{!o&&c.return&&c.return()}finally{if(i)throw s}}}else{try{t[e]=n}catch(t){}"function"!=typeof n&&n?t.setAttribute(e,n):t.removeAttribute(e)}}function r(t,e){var r=(e=e||"svg"===t.type)?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type);for(var i in t.props)n(r,i,t.props[i]);return t.children.map(function(t){return r.appendChild(o(t,e))}),r}function o(t,e){return"string"==typeof t?document.createTextNode(t):r(t,e)}function i(t){if(t&&(t=t.props))return t.key}function s(t,e,r){for(var o in u(e,r)){var i=r[o],s="value"===o||"checked"===o?t[o]:e[o];i!==s&&n(t,o,i,s)}}function a(t,e,n,r,u,l){if(null==n)e=t.insertBefore(o(r,u),e);else if(null!=r.type&&r.type===n.type){s(e,n.props,r.props),u=u||"svg"===r.type;for(var h=r.children.length,f=n.children.length,p={},d=[],m={},y=0;y<f;){var v=d[y]=e.childNodes[y],b=n.children[y],w=i(b);null!=w&&(p[w]=[v,b]),y++}for(var g=0,S=0;S<h;){var k=d[g],x=n.children[g],A=r.children[S],E=i(x);if(m[E])g++;else{var C=i(A),j=p[C]||[];null==C?(null==E&&(a(e,k,x,A,u),S++),g++):(E===C?a(e,j[0],j[1],A,u)&&g++:j[0]?e.insertBefore(j[0],k)&&a(e,j[0],j[1],A,u):a(e,k,null,A,u),m[C]=A,S++)}}for(;g<f;){var W=n.children[g];null==i(W)&&c(e,d[g],W.props),g++}for(var U in p){var O=p[U],_=O[1];m[_.props.key]||c(e,O[0],_.props)}}else e&&r!==e.nodeValue&&(e=t.insertBefore(o(r,u),l=e),c(t,l,n.props));return e}var u=function(t,e){return Object.assign({},t,e)},c=function(t,e){return t.removeChild(e)},l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=(function(){function t(t){this.value=t}function e(e){function n(o,i){try{var s=e[o](i),a=s.value;a instanceof t?Promise.resolve(a.value).then(function(t){n("next",t)},function(t){n("throw",t)}):r(s.done?"return":"normal",s.value)}catch(t){r("throw",t)}}function r(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(t,e){return new Promise(function(r,s){var a={key:t,arg:e,resolve:r,reject:s,next:null};i?i=i.next=a:(o=i=a,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),p=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,16)},d=function(t,e){Object.keys(e).forEach(function(n){e.hasOwnProperty(n)&&Object.defineProperty(t,n,{value:e[n],writable:!0,enumerable:!1,configurable:!0})})},m=Symbol?Symbol():(new Date).getTime(),y=function(){function t(e){if(h(this,t),e||(e={}),this.props=e,this.selector=this.props.element||this.props.root,this.props.render&&(this.render=this.props.render),this[m]=this.props.state,this.oldNode=null,this.styles=this.props.styles,this.root=document.querySelector(this.selector),this.scopedStylesheet=!1,this.mounted=!1,this.element,this.createComponentStyles=function(){function t(t){for(var e=Array.prototype.concat(t),n=0;n<e.length;n++)Array.isArray(e[n])&&e.splice(n,1,e[n--]);return e}function e(t){if(!(this instanceof e))return new e(t);t||(t={}),t.prefix=!t.hasOwnProperty("prefix")||!!t.prefix,t.unit=t.hasOwnProperty("unit")?t.unit:"px",this._sheet=null,this._prefix=null,this.css=function(e,i,a){if(null==i)return"";null==this._sheet&&(this._sheet=u=u||n());var c=r(a=e,i);(t.prefix||""!==t.unit)&&c.forEach(function(e){""!==t.unit&&s(e[1],t.unit)}),o(c,this._sheet)}}function n(){if(null==document.head)throw new Error("Can't add stylesheet before <head> is available. Make sure your document has a head element.");var t=document.createElement("style");return t.id="styles_"+Math.random().toString(16).slice(2,8),document.head.appendChild(t),t.sheet}function r(e,n){Array.isArray(n)||(n=[n]);var o={},s=[];return(n=t(n)).forEach(function(t){for(var n in t){var u=t[n];a(u)||Array.isArray(u)?s=s.concat(r(i(e,n),u)):("content"===n&&(u="'"+u+"'"),o[n]=u)}}),s.push([e,o]),s}function o(t,e){function n(t){return t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})}window.sheet=e,t.forEach(function(t){var r=[];for(var o in t[1])r.push(n(o)+":"+t[1][o]);if(r.length>0){var i=t[0]?t[0]:"";e.insertRule(i+"{"+r.join(";")+"}",0)}})}function i(t,e){var n=/^[:\[]/,r=t.split(","),o=e.split(",");return r.map(function(t){return o.map(function(e){var r=n.test(e)?"":" ";return t+r+e}).join(",")}).join(",")}function s(t,e){for(var n in t){var r=t[n]+"";isNaN(r)||c[n]||(r+=e),t[n]=r}return t}function a(t){return t===Object(t)&&Object.prototype.toString===t.toString}var u=null,c={columnCount:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},l={};return l.css=e().css,l},this.handleEvents=function(){if(this.interactions){var t=this,e=!1;if(Array.isArray(this.interactions)){if(!this.interactions.length)return;this.interactions.forEach(function(n){e=n.bubble,n&&"self"===n.element||n&&!n.element?t.root.addEventListener(n.event,n.callback,e):t.root.addEventListener(n.event,function(e){var r=e.target;3===e.target.nodeType&&(r=e.target.parentNode),[].slice.call(t.root.querySelectorAll(n.element)).forEach(function(t){t===r&&n.callback.call(t,e)})})})}}},this.props.interactions&&(this.interactions=this.props.interactions),this.interactions&&this.handleEvents(),this.props.methods){var n=this;for(var r in this.props.methods)n[r]=this.props.methods[r]}e.componentWasCreated&&(this.componentWasCreated=e.componentWasCreated),e.componentWillUpdate&&(this.componentWillUpdate=e.componentWillUpdate),e.componentDidUpdate&&(this.componentDidUpdate=e.componentDidUpdate),e.componentWillUnmount&&(this.componentWillUnmount=e.componentWillUnmount)}return f(t,[{key:"setState",value:function(t,e){if(Array.isArray(this.state)){var n=this.state;e||0===e?"object"===l(n[e])?(d(n[e],t),this.state=n):(n[e]=t,this.state=n):this.state=n}else if("object"===l(this.state)){var r=this.state;d(r,t),this.state=r}else this.state=t}},{key:"update",value:function(t){if(this.render){var n=t||this.state;if(this.componentWillUpdate&&this.componentWillUpdate(this),this.root&&"string"==typeof this.root&&(this.root=document.querySelector),this.element=e(this.oldNode,this.oldNode=this.render(n),this.element,this.root),!this.mounted){if(this.styles&&this.root&&this.root.nodeName){var r=this.createComponentStyles();if("object"!==l(this.styles))return;r.css(this.selector,this.styles)}this.handleEvents(),this.componentWasCreated&&this.componentWasCreated(this),this.mounted=!0}this.componentDidUpdate&&this.componentDidUpdate(this)}}},{key:"unmount",value:function(){var t=this;this.componentWillUnmount&&this.componentWillUnmount(this),this.interactions&&this.interactions.length&&this.interactions.forEach(function(e){t.root.removeEvent(e.event,e.callback)}),this.root.removeChild(this.element),this.root=void 0;for(var e in this)delete this[e];delete this.state,this.update=void 0,this.unmount=void 0}},{key:"state",set:function(t){var e=this;this[m]=t,p(function(){e.update()})},get:function(){return this[m]}}]),t}(),v={};t.h=function(t,e){for(var n=[],r=void 0,o=[],i=arguments.length,s=Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];for(n=n.concat(s.reverse());n.length;)Array.isArray(r=n.pop())?r.map(function(t){return n.unshift(t)}):null!=r&&!0!==r&&!1!==r&&("number"==typeof r&&(r+=""),o.push(r));return"string"==typeof t?{type:t,props:e||{},children:o}:t(e,o)},t.patch=e,t.Component=y,t.injectElement=function(t,e,n){"string"==typeof e&&(e=document.querySelector(e)),e&&"boolean"!=typeof e||(n=e,e=document.body);var r=o(t);n&&(e.textContent=""),e.append(r)},t.subscribe=function(t,e){v.hasOwnProperty.call(v,t)||(v[t]=[]);v[t].push(e)},t.dispatch=function(t,e){v.hasOwnProperty.call(v,t)&&v[t].map(function(t){return t(void 0!=e?e:{})})},t.unsubscribe=function(t){return delete v[t]},t.uuid=function(t){var e=""+1e7+-1e3+-4e3+-1e3+-1e11;t||(e="10000000100040008000"+1e11);var n=Date.now();return n+=performance.now(),e.replace(/1|0/g,function(){return(0|(n+16*Math.random())%16).toString(16)})},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=composi.js.map
